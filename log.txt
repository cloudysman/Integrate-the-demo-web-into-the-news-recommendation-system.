PS D:\HieuDT\news-recommendation\src> python test.py
True
0
NVIDIA GeForce RTX 4070 SUPER
2.4.0+cu118
PS D:\HieuDT\news-recommendation\src> python train.py 
Using device: cuda:0
Training model NRMS
NRMS(
  (news_encoder): NewsEncoder(
    (word_embedding): Embedding(101222, 300, padding_idx=0)
    (multihead_self_attention): MultiHeadSelfAttention(
      (W_Q): Linear(in_features=300, out_features=300, bias=True)
      (W_K): Linear(in_features=300, out_features=300, bias=True)
      (W_V): Linear(in_features=300, out_features=300, bias=True)
    )
    (additive_attention): AdditiveAttention(
      (linear): Linear(in_features=300, out_features=200, bias=True)
    )
  )
  (user_encoder): UserEncoder(
    (multihead_self_attention): MultiHeadSelfAttention(
      (W_Q): Linear(in_features=300, out_features=300, bias=True)
      (W_K): Linear(in_features=300, out_features=300, bias=True)
      (W_V): Linear(in_features=300, out_features=300, bias=True)
    )
    (additive_attention): AdditiveAttention(
      (linear): Linear(in_features=300, out_features=200, bias=True)
    )
  )
  (click_predictor): DotProductClickPredictor()
)
Load training dataset with size 3227275.
Time 00.00.17, batches 100, current loss 1.0209, average loss: 1.2144, latest average loss: 1.2144
Time 00.00.34, batches 200, current loss 1.0548, average loss: 1.1421, latest average loss: 1.1421          
Time 00.00.51, batches 300, current loss 1.0549, average loss: 1.1112, latest average loss: 1.0685          
Time 00.01.08, batches 400, current loss 1.0774, average loss: 1.0961, latest average loss: 1.0522          
Time 00.01.25, batches 500, current loss 1.0470, average loss: 1.0861, latest average loss: 1.0480          
Time 00.01.42, batches 600, current loss 0.9803, average loss: 1.0769, latest average loss: 1.0413          
Time 00.01.58, batches 700, current loss 0.9859, average loss: 1.0689, latest average loss: 1.0313          
Time 00.02.15, batches 800, current loss 0.9643, average loss: 1.0620, latest average loss: 1.0197          
Time 00.02.31, batches 900, current loss 0.9903, average loss: 1.0563, latest average loss: 1.0133          
Time 00.02.47, batches 1000, current loss 1.0363, average loss: 1.0509, latest average loss: 1.0083         
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:54<00:00,  1.52s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [01:47<00:00,  1.17it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:30<03:58, 739.94it/s] 
Time 00.10.51, batches 1000, validation AUC: 0.5718, validation MRR: 0.2522, validation nDCG@5: 0.2693, validation nDCG@10: 0.3358,
Time 00.11.10, batches 1100, current loss 0.9514, average loss: 1.0451, latest average loss: 0.9977         
Time 00.11.27, batches 1200, current loss 1.0278, average loss: 1.0403, latest average loss: 0.9899         
Time 00.11.44, batches 1300, current loss 0.9632, average loss: 1.0361, latest average loss: 0.9858         
Time 00.12.01, batches 1400, current loss 1.0293, average loss: 1.0316, latest average loss: 0.9809         
Time 00.12.18, batches 1500, current loss 0.9728, average loss: 1.0269, latest average loss: 0.9708         
Time 00.12.35, batches 1600, current loss 0.9115, average loss: 1.0228, latest average loss: 0.9623         
Time 00.12.51, batches 1700, current loss 0.9600, average loss: 1.0189, latest average loss: 0.9590         
Time 00.13.08, batches 1800, current loss 0.9550, average loss: 1.0158, latest average loss: 0.9601         
Time 00.13.25, batches 1900, current loss 0.9594, average loss: 1.0125, latest average loss: 0.9587         
Time 00.13.42, batches 2000, current loss 0.9647, average loss: 1.0094, latest average loss: 0.9522         
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [01:03<00:00,  1.78s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:07<00:00,  1.02s/it] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [05:12<04:35, 640.81it/s] 
Time 00.22.58, batches 2000, validation AUC: 0.6126, validation MRR: 0.2720, validation nDCG@5: 0.2947, validation nDCG@10: 0.3612,
Time 00.23.16, batches 2100, current loss 0.9368, average loss: 1.0059, latest average loss: 0.9463         
Time 00.23.32, batches 2200, current loss 1.0047, average loss: 1.0033, latest average loss: 0.9455         
Time 00.23.49, batches 2300, current loss 0.9592, average loss: 1.0007, latest average loss: 0.9453         
Time 00.24.05, batches 2400, current loss 0.9507, average loss: 0.9983, latest average loss: 0.9439         
Time 00.24.21, batches 2500, current loss 0.9431, average loss: 0.9962, latest average loss: 0.9452         
Time 00.24.37, batches 2600, current loss 0.9566, average loss: 0.9938, latest average loss: 0.9408         
Time 00.24.54, batches 2700, current loss 0.9554, average loss: 0.9919, latest average loss: 0.9407         
Time 00.25.10, batches 2800, current loss 1.0030, average loss: 0.9900, latest average loss: 0.9376         
Time 00.25.26, batches 2900, current loss 0.9838, average loss: 0.9880, latest average loss: 0.9367         
Time 00.25.42, batches 3000, current loss 0.8819, average loss: 0.9861, latest average loss: 0.9344         
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:54<00:00,  1.51s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [01:57<00:00,  1.06it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:39<04:07, 714.45it/s] 
Time 00.34.06, batches 3000, validation AUC: 0.6294, validation MRR: 0.2825, validation nDCG@5: 0.3094, validation nDCG@10: 0.3750,
Time 00.34.25, batches 3100, current loss 0.9617, average loss: 0.9840, latest average loss: 0.9258         
Time 00.34.41, batches 3200, current loss 0.9009, average loss: 0.9823, latest average loss: 0.9262         
Time 00.34.57, batches 3300, current loss 0.8527, average loss: 0.9806, latest average loss: 0.9274         
Time 00.35.13, batches 3400, current loss 0.9605, average loss: 0.9790, latest average loss: 0.9268         
Time 00.35.30, batches 3500, current loss 0.9131, average loss: 0.9774, latest average loss: 0.9243         
Time 00.35.46, batches 3600, current loss 1.0634, average loss: 0.9760, latest average loss: 0.9244         
Time 00.36.02, batches 3700, current loss 0.9027, average loss: 0.9744, latest average loss: 0.9214         
Time 00.36.18, batches 3800, current loss 0.9404, average loss: 0.9729, latest average loss: 0.9196         
Time 00.36.34, batches 3900, current loss 0.8360, average loss: 0.9715, latest average loss: 0.9170         
Time 00.36.50, batches 4000, current loss 0.8666, average loss: 0.9702, latest average loss: 0.9189         
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:53<00:00,  1.50s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [01:48<00:00,  1.15it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:52<04:17, 684.44it/s] 
Time 00.45.17, batches 4000, validation AUC: 0.6294, validation MRR: 0.2830, validation nDCG@5: 0.3081, validation nDCG@10: 0.3754,
Time 00.45.37, batches 4100, current loss 0.9505, average loss: 0.9686, latest average loss: 0.9137         
Time 00.45.53, batches 4200, current loss 0.8854, average loss: 0.9673, latest average loss: 0.9113         
Time 00.46.10, batches 4300, current loss 0.9968, average loss: 0.9660, latest average loss: 0.9114         
Time 00.46.27, batches 4400, current loss 0.9491, average loss: 0.9649, latest average loss: 0.9129         
Time 00.46.44, batches 4500, current loss 0.8146, average loss: 0.9636, latest average loss: 0.9150         
Time 00.47.00, batches 4600, current loss 0.8895, average loss: 0.9625, latest average loss: 0.9121         
Time 00.47.17, batches 4700, current loss 0.9312, average loss: 0.9614, latest average loss: 0.9107         
Time 00.47.34, batches 4800, current loss 0.9900, average loss: 0.9604, latest average loss: 0.9124         
Time 00.47.51, batches 4900, current loss 0.8102, average loss: 0.9594, latest average loss: 0.9119         
Time 00.48.08, batches 5000, current loss 0.9335, average loss: 0.9584, latest average loss: 0.9112         
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [01:04<00:00,  1.80s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:04<00:00,  1.00it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:34<04:02, 727.71it/s] 
Time 00.56.44, batches 5000, validation AUC: 0.6309, validation MRR: 0.2823, validation nDCG@5: 0.3093, validation nDCG@10: 0.3759,
Time 00.57.05, batches 5100, current loss 0.8838, average loss: 0.9575, latest average loss: 0.9120         
Time 00.57.23, batches 5200, current loss 1.0070, average loss: 0.9567, latest average loss: 0.9141         
Time 00.57.41, batches 5300, current loss 0.8842, average loss: 0.9557, latest average loss: 0.9118         
Time 00.57.58, batches 5400, current loss 0.9504, average loss: 0.9548, latest average loss: 0.9096         
Time 00.57.41, batches 5300, current loss 0.8842, average loss: 0.9557, latest average loss: 0.9118
Time 00.57.58, batches 5400, current loss 0.9504, average loss: 0.9548, latest average loss: 0.9096
Time 00.58.16, batches 5500, current loss 0.8451, average loss: 0.9539, latest average loss: 0.9043
Time 00.58.34, batches 5600, current loss 0.9121, average loss: 0.9531, latest average loss: 0.9075
Time 00.58.34, batches 5600, current loss 0.9121, average loss: 0.9531, latest average loss: 0.9075
Time 00.58.52, batches 5700, current loss 0.9813, average loss: 0.9522, latest average loss: 0.9047
Time 00.59.10, batches 5800, current loss 0.9089, average loss: 0.9514, latest average loss: 0.9052
Time 00.59.28, batches 5900, current loss 0.9889, average loss: 0.9506, latest average loss: 0.9044
Time 00.59.44, batches 6000, current loss 0.8331, average loss: 0.9498, latest average loss: 0.9027
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:54<00:00,  1.52s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [01:53<00:00,  1.10it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [05:05<04:29, 655.19it/s] 
Time 01.08.32, batches 6000, validation AUC: 0.6357, validation MRR: 0.2859, validation nDCG@5: 0.3123, validation nDCG@10: 0.3791,
Time 01.08.50, batches 6100, current loss 0.8918, average loss: 0.9489, latest average loss: 0.8994         
Time 01.09.07, batches 6200, current loss 0.8570, average loss: 0.9480, latest average loss: 0.8956         
Time 01.09.24, batches 6300, current loss 0.8472, average loss: 0.9472, latest average loss: 0.8956         
Time 01.09.40, batches 6400, current loss 0.9350, average loss: 0.9465, latest average loss: 0.8978         
Time 01.09.57, batches 6500, current loss 0.8981, average loss: 0.9457, latest average loss: 0.8965         
Time 01.10.14, batches 6600, current loss 0.8492, average loss: 0.9449, latest average loss: 0.8955         
Time 01.10.31, batches 6700, current loss 0.9929, average loss: 0.9442, latest average loss: 0.8948         
Time 01.10.48, batches 6800, current loss 0.8730, average loss: 0.9434, latest average loss: 0.8951         
Time 01.11.04, batches 6900, current loss 0.8894, average loss: 0.9428, latest average loss: 0.8982         
Time 01.11.21, batches 7000, current loss 0.8700, average loss: 0.9421, latest average loss: 0.8971         
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [01:06<00:00,  1.86s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:05<00:00,  1.00s/it] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [05:01<04:26, 663.19it/s] 
Time 01.20.29, batches 7000, validation AUC: 0.6406, validation MRR: 0.2902, validation nDCG@5: 0.3191, validation nDCG@10: 0.3850,
Time 01.20.49, batches 7100, current loss 0.7895, average loss: 0.9413, latest average loss: 0.8937         
Time 01.21.06, batches 7200, current loss 0.8888, average loss: 0.9407, latest average loss: 0.8906         
Time 01.21.23, batches 7300, current loss 0.9173, average loss: 0.9400, latest average loss: 0.8919
Time 01.21.23, batches 7300, current loss 0.9173, average loss: 0.9400, latest average loss: 0.8919
Time 01.21.23, batches 7300, current loss 0.9173, average loss: 0.9400, latest average loss: 0.8919
Time 01.21.23, batches 7300, current loss 0.9173, average loss: 0.9400, latest average loss: 0.8919
Time 01.21.23, batches 7300, current loss 0.9173, average loss: 0.9400, latest average loss: 0.8919
Time 01.21.40, batches 7400, current loss 0.8260, average loss: 0.9395, latest average loss: 0.8963
Time 01.21.56, batches 7500, current loss 0.9827, average loss: 0.9389, latest average loss: 0.8976
Time 01.22.13, batches 7600, current loss 0.9199, average loss: 0.9382, latest average loss: 0.8923
Time 01.22.30, batches 7700, current loss 0.9464, average loss: 0.9375, latest average loss: 0.8865
Time 01.22.46, batches 7800, current loss 0.9436, average loss: 0.9368, latest average loss: 0.8838
Time 01.23.02, batches 7900, current loss 0.9030, average loss: 0.9362, latest average loss: 0.8874
Time 01.23.18, batches 8000, current loss 0.8149, average loss: 0.9357, latest average loss: 0.8924
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [01:04<00:00,  1.78s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [01:55<00:00,  1.08it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:55<04:21, 676.11it/s] 
Time 01.32.05, batches 8000, validation AUC: 0.6428, validation MRR: 0.2908, validation nDCG@5: 0.3182, validation nDCG@10: 0.3850,
Time 01.32.23, batches 8100, current loss 0.9489, average loss: 0.9352, latest average loss: 0.8929         
Time 01.32.40, batches 8200, current loss 0.9231, average loss: 0.9346, latest average loss: 0.8894         
Time 01.32.56, batches 8300, current loss 0.9896, average loss: 0.9341, latest average loss: 0.8900         
Time 01.33.13, batches 8400, current loss 0.9678, average loss: 0.9336, latest average loss: 0.8914         
Time 01.33.29, batches 8500, current loss 0.9501, average loss: 0.9330, latest average loss: 0.8891         
Time 01.33.46, batches 8600, current loss 0.9371, average loss: 0.9326, latest average loss: 0.8892         
Time 01.34.02, batches 8700, current loss 0.8705, average loss: 0.9322, latest average loss: 0.8936         
Time 01.34.18, batches 8800, current loss 0.9148, average loss: 0.9317, latest average loss: 0.8936         
Time 01.34.34, batches 8900, current loss 0.8314, average loss: 0.9312, latest average loss: 0.8931         
Time 01.34.50, batches 9000, current loss 0.8272, average loss: 0.9307, latest average loss: 0.8880         
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:54<00:00,  1.51s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [01:52<00:00,  1.11it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:40<04:07, 711.79it/s] 
Time 01.43.10, batches 9000, validation AUC: 0.6416, validation MRR: 0.2894, validation nDCG@5: 0.3170, validation nDCG@10: 0.3843,
Time 01.43.30, batches 9100, current loss 0.9237, average loss: 0.9300, latest average loss: 0.8797         
Time 01.43.47, batches 9200, current loss 0.9167, average loss: 0.9295, latest average loss: 0.8784         
Time 01.44.05, batches 9300, current loss 0.9063, average loss: 0.9291, latest average loss: 0.8810         
Time 01.44.22, batches 9400, current loss 0.8593, average loss: 0.9286, latest average loss: 0.8842         
Time 01.44.40, batches 9500, current loss 0.8777, average loss: 0.9282, latest average loss: 0.8893         
Time 01.44.57, batches 9600, current loss 0.8101, average loss: 0.9278, latest average loss: 0.8887         
Time 01.45.15, batches 9700, current loss 0.8805, average loss: 0.9273, latest average loss: 0.8879         
Time 01.45.32, batches 9800, current loss 0.8227, average loss: 0.9270, latest average loss: 0.8882         
Time 01.45.49, batches 9900, current loss 0.9724, average loss: 0.9265, latest average loss: 0.8871         
Time 01.46.06, batches 10000, current loss 0.8647, average loss: 0.9261, latest average loss: 0.8836        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:58<00:00,  1.61s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [01:57<00:00,  1.06it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:24<03:53, 755.00it/s] 
Time 01.54.19, batches 10000, validation AUC: 0.6457, validation MRR: 0.2926, validation nDCG@5: 0.3218, validation nDCG@10: 0.3879,
Time 01.54.41, batches 10100, current loss 0.9115, average loss: 0.9258, latest average loss: 0.8848        
Time 01.54.59, batches 10200, current loss 0.8113, average loss: 0.9252, latest average loss: 0.8818        
Time 01.55.17, batches 10300, current loss 0.9274, average loss: 0.9249, latest average loss: 0.8812        
Time 01.55.35, batches 10400, current loss 0.8578, average loss: 0.9245, latest average loss: 0.8874        
Time 01.55.53, batches 10500, current loss 0.8606, average loss: 0.9240, latest average loss: 0.8809        
Time 01.56.11, batches 10600, current loss 0.8472, average loss: 0.9236, latest average loss: 0.8766        
Time 01.56.30, batches 10700, current loss 0.9894, average loss: 0.9232, latest average loss: 0.8779        
Time 01.56.48, batches 10800, current loss 0.9114, average loss: 0.9228, latest average loss: 0.8823        
Time 01.57.06, batches 10900, current loss 0.8423, average loss: 0.9224, latest average loss: 0.8822        
Time 01.57.24, batches 11000, current loss 0.8707, average loss: 0.9221, latest average loss: 0.8829        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:58<00:00,  1.63s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [01:56<00:00,  1.07it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [06:43<05:56, 495.48it/s] 
Time 02.07.55, batches 11000, validation AUC: 0.6468, validation MRR: 0.2931, validation nDCG@5: 0.3227, validation nDCG@10: 0.3889,
Time 02.08.16, batches 11100, current loss 0.9539, average loss: 0.9217, latest average loss: 0.8812        
Time 02.08.34, batches 11200, current loss 0.8665, average loss: 0.9214, latest average loss: 0.8828        
Time 02.08.52, batches 11300, current loss 0.9339, average loss: 0.9211, latest average loss: 0.8835        
Time 02.09.10, batches 11400, current loss 0.8558, average loss: 0.9207, latest average loss: 0.8825        
Time 02.09.28, batches 11500, current loss 0.8476, average loss: 0.9203, latest average loss: 0.8785        
Time 02.09.46, batches 11600, current loss 0.7732, average loss: 0.9199, latest average loss: 0.8752        
Time 02.10.05, batches 11700, current loss 0.9852, average loss: 0.9196, latest average loss: 0.8757        
Time 02.10.23, batches 11800, current loss 0.9151, average loss: 0.9192, latest average loss: 0.8789        
Time 02.10.41, batches 11900, current loss 0.8697, average loss: 0.9188, latest average loss: 0.8788        
Time 02.10.59, batches 12000, current loss 0.8134, average loss: 0.9185, latest average loss: 0.8749        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.60s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:03<00:00,  1.01it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:25<03:54, 751.90it/s] 
Time 02.19.19, batches 12000, validation AUC: 0.6448, validation MRR: 0.2940, validation nDCG@5: 0.3235, validation nDCG@10: 0.3893,
Time 02.19.40, batches 12100, current loss 0.8452, average loss: 0.9181, latest average loss: 0.8739        
Time 02.19.58, batches 12200, current loss 0.8712, average loss: 0.9177, latest average loss: 0.8705        
Time 02.20.17, batches 12300, current loss 0.8988, average loss: 0.9174, latest average loss: 0.8768        
Time 02.20.35, batches 12400, current loss 0.8849, average loss: 0.9171, latest average loss: 0.8799        
Time 02.20.53, batches 12500, current loss 0.8808, average loss: 0.9168, latest average loss: 0.8809        
Time 02.21.11, batches 12600, current loss 0.8663, average loss: 0.9164, latest average loss: 0.8737        
Time 02.21.29, batches 12700, current loss 0.8545, average loss: 0.9161, latest average loss: 0.8704        
Time 02.21.47, batches 12800, current loss 1.0254, average loss: 0.9158, latest average loss: 0.8712        
Time 02.22.19, batches 12900, current loss 0.8219, average loss: 0.9154, latest average loss: 0.8734        
Time 02.22.38, batches 13000, current loss 0.8338, average loss: 0.9152, latest average loss: 0.8769        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.61s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:03<00:00,  1.01it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:25<03:54, 752.87it/s] 
Time 02.30.58, batches 13000, validation AUC: 0.6509, validation MRR: 0.2970, validation nDCG@5: 0.3285, validation nDCG@10: 0.3937,
Time 02.31.18, batches 13100, current loss 0.8355, average loss: 0.9148, latest average loss: 0.8774        
Time 02.31.37, batches 13200, current loss 0.9504, average loss: 0.9145, latest average loss: 0.8746        
Time 02.31.55, batches 13300, current loss 0.9129, average loss: 0.9142, latest average loss: 0.8732        
Time 02.32.13, batches 13400, current loss 0.8661, average loss: 0.9139, latest average loss: 0.8687        
Time 02.32.31, batches 13500, current loss 0.8149, average loss: 0.9136, latest average loss: 0.8690        
Time 02.32.49, batches 13600, current loss 0.8419, average loss: 0.9132, latest average loss: 0.8710        
Time 02.33.07, batches 13700, current loss 0.8728, average loss: 0.9129, latest average loss: 0.8721        
Time 02.33.25, batches 13800, current loss 0.9013, average loss: 0.9126, latest average loss: 0.8655        
Time 02.33.43, batches 13900, current loss 0.8733, average loss: 0.9122, latest average loss: 0.8635        
Time 02.34.02, batches 14000, current loss 0.8084, average loss: 0.9120, latest average loss: 0.8715        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.59s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:02<00:00,  1.02it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:23<03:52, 759.82it/s] 
Time 02.42.17, batches 14000, validation AUC: 0.6499, validation MRR: 0.2957, validation nDCG@5: 0.3267, validation nDCG@10: 0.3924,
Time 02.42.38, batches 14100, current loss 0.9334, average loss: 0.9117, latest average loss: 0.8719        
Time 02.43.10, batches 14200, current loss 0.8552, average loss: 0.9114, latest average loss: 0.8741        
Time 02.43.28, batches 14300, current loss 0.8924, average loss: 0.9111, latest average loss: 0.8694        
Time 02.43.47, batches 14400, current loss 0.9156, average loss: 0.9109, latest average loss: 0.8702        
Time 02.44.05, batches 14500, current loss 0.8264, average loss: 0.9105, latest average loss: 0.8670        
Time 02.44.23, batches 14600, current loss 0.8415, average loss: 0.9102, latest average loss: 0.8680        
Time 02.44.41, batches 14700, current loss 0.8666, average loss: 0.9100, latest average loss: 0.8674        
Time 02.44.59, batches 14800, current loss 0.8944, average loss: 0.9097, latest average loss: 0.8661        
Time 02.45.17, batches 14900, current loss 0.8464, average loss: 0.9094, latest average loss: 0.8702        
Time 02.45.35, batches 15000, current loss 0.9790, average loss: 0.9091, latest average loss: 0.8669        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.59s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:01<00:00,  1.03it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:23<03:52, 759.47it/s] 
Time 02.53.51, batches 15000, validation AUC: 0.6471, validation MRR: 0.2932, validation nDCG@5: 0.3235, validation nDCG@10: 0.3902,
Time 02.54.12, batches 15100, current loss 0.8713, average loss: 0.9089, latest average loss: 0.8684        
Time 02.54.30, batches 15200, current loss 0.8315, average loss: 0.9085, latest average loss: 0.8652        
Time 02.54.48, batches 15300, current loss 0.9020, average loss: 0.9082, latest average loss: 0.8630        
Time 02.55.06, batches 15400, current loss 0.8643, average loss: 0.9080, latest average loss: 0.8671        
Time 02.55.24, batches 15500, current loss 0.8924, average loss: 0.9078, latest average loss: 0.8686        
Time 02.55.42, batches 15600, current loss 0.9615, average loss: 0.9075, latest average loss: 0.8694        
Time 02.56.00, batches 15700, current loss 0.7837, average loss: 0.9072, latest average loss: 0.8683        
Time 02.56.19, batches 15800, current loss 0.9011, average loss: 0.9070, latest average loss: 0.8662        
Time 02.56.37, batches 15900, current loss 0.9407, average loss: 0.9067, latest average loss: 0.8645        
Time 02.56.55, batches 16000, current loss 0.7815, average loss: 0.9065, latest average loss: 0.8693        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.60s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:00<00:00,  1.04it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:42<04:09, 706.74it/s] 
Time 03.05.28, batches 16000, validation AUC: 0.6496, validation MRR: 0.2973, validation nDCG@5: 0.3273, validation nDCG@10: 0.3938,
Time 03.05.48, batches 16100, current loss 0.8162, average loss: 0.9063, latest average loss: 0.8711        
Time 03.06.07, batches 16200, current loss 0.8317, average loss: 0.9060, latest average loss: 0.8681        
Time 03.06.25, batches 16300, current loss 0.8520, average loss: 0.9058, latest average loss: 0.8707        
Time 03.06.43, batches 16400, current loss 0.8449, average loss: 0.9056, latest average loss: 0.8660        
Time 03.07.01, batches 16500, current loss 0.8477, average loss: 0.9053, latest average loss: 0.8630        
Time 03.07.19, batches 16600, current loss 0.9301, average loss: 0.9051, latest average loss: 0.8627        
Time 03.07.37, batches 16700, current loss 0.8130, average loss: 0.9048, latest average loss: 0.8683        
Time 03.07.55, batches 16800, current loss 0.8114, average loss: 0.9047, latest average loss: 0.8697        
Time 03.08.13, batches 16900, current loss 0.9525, average loss: 0.9044, latest average loss: 0.8691        
Time 03.08.32, batches 17000, current loss 0.8309, average loss: 0.9042, latest average loss: 0.8677        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.60s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:00<00:00,  1.04it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:27<03:56, 747.29it/s] 
Time 03.16.50, batches 17000, validation AUC: 0.6507, validation MRR: 0.2942, validation nDCG@5: 0.3248, validation nDCG@10: 0.3913,
Time 03.17.12, batches 17100, current loss 0.8553, average loss: 0.9040, latest average loss: 0.8681        
Time 03.17.30, batches 17200, current loss 0.7719, average loss: 0.9037, latest average loss: 0.8657        
Time 03.17.48, batches 17300, current loss 0.8295, average loss: 0.9035, latest average loss: 0.8644        
Time 03.18.06, batches 17400, current loss 0.9409, average loss: 0.9033, latest average loss: 0.8649        
Time 03.18.24, batches 17500, current loss 0.8845, average loss: 0.9031, latest average loss: 0.8649        
Time 03.18.42, batches 17600, current loss 0.8165, average loss: 0.9029, latest average loss: 0.8633        
Time 03.19.00, batches 17700, current loss 0.8723, average loss: 0.9026, latest average loss: 0.8641        
Time 03.19.18, batches 17800, current loss 0.9677, average loss: 0.9024, latest average loss: 0.8646        
Time 03.19.36, batches 17900, current loss 0.9104, average loss: 0.9023, latest average loss: 0.8685        
Time 03.19.55, batches 18000, current loss 0.8794, average loss: 0.9021, latest average loss: 0.8685        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.59s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:02<00:00,  1.02it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:45<04:12, 699.51it/s] 
Time 03.28.32, batches 18000, validation AUC: 0.6514, validation MRR: 0.2976, validation nDCG@5: 0.3285, validation nDCG@10: 0.3947,
Time 03.28.53, batches 18100, current loss 0.7917, average loss: 0.9018, latest average loss: 0.8648        
Time 03.29.11, batches 18200, current loss 0.8427, average loss: 0.9016, latest average loss: 0.8563        
Time 03.29.29, batches 18300, current loss 0.9102, average loss: 0.9013, latest average loss: 0.8593        
Time 03.29.47, batches 18400, current loss 0.9386, average loss: 0.9011, latest average loss: 0.8602        
Time 03.30.05, batches 18500, current loss 0.8357, average loss: 0.9009, latest average loss: 0.8635        
Time 03.30.23, batches 18600, current loss 0.8968, average loss: 0.9007, latest average loss: 0.8616        
Time 03.30.41, batches 18700, current loss 0.8756, average loss: 0.9006, latest average loss: 0.8662        
Time 03.30.59, batches 18800, current loss 0.8594, average loss: 0.9004, latest average loss: 0.8704        
Time 03.31.17, batches 18900, current loss 0.8335, average loss: 0.9002, latest average loss: 0.8660        
Time 03.31.36, batches 19000, current loss 0.9629, average loss: 0.9000, latest average loss: 0.8640        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.60s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:03<00:00,  1.01it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:25<03:54, 752.04it/s] 
Time 03.39.56, batches 19000, validation AUC: 0.6541, validation MRR: 0.2993, validation nDCG@5: 0.3301, validation nDCG@10: 0.3963,
Time 03.40.16, batches 19100, current loss 0.8719, average loss: 0.8998, latest average loss: 0.8653        
Time 03.40.35, batches 19200, current loss 0.9170, average loss: 0.8996, latest average loss: 0.8678        
Time 03.40.53, batches 19300, current loss 0.9039, average loss: 0.8995, latest average loss: 0.8678        
Time 03.41.11, batches 19400, current loss 0.8562, average loss: 0.8993, latest average loss: 0.8672        
Time 03.41.29, batches 19500, current loss 0.8778, average loss: 0.8991, latest average loss: 0.8631        
Time 03.41.47, batches 19600, current loss 0.8926, average loss: 0.8989, latest average loss: 0.8605        
Time 03.42.05, batches 19700, current loss 0.7759, average loss: 0.8986, latest average loss: 0.8553        
Time 03.42.23, batches 19800, current loss 0.9010, average loss: 0.8984, latest average loss: 0.8572        
Time 03.42.42, batches 19900, current loss 0.8675, average loss: 0.8982, latest average loss: 0.8595        
Time 03.43.00, batches 20000, current loss 0.9097, average loss: 0.8981, latest average loss: 0.8612        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.60s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:12<00:00,  1.06s/it] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:29<03:57, 743.14it/s] 
Time 03.51.31, batches 20000, validation AUC: 0.6545, validation MRR: 0.2984, validation nDCG@5: 0.3290, validation nDCG@10: 0.3956,
Time 03.51.52, batches 20100, current loss 0.7675, average loss: 0.8978, latest average loss: 0.8560        
Time 03.52.10, batches 20200, current loss 0.8912, average loss: 0.8977, latest average loss: 0.8587        
Time 03.52.28, batches 20300, current loss 0.7945, average loss: 0.8975, latest average loss: 0.8605        
Time 03.52.46, batches 20400, current loss 0.9678, average loss: 0.8973, latest average loss: 0.8597        
Time 03.53.04, batches 20500, current loss 0.9181, average loss: 0.8971, latest average loss: 0.8564        
Time 03.53.23, batches 20600, current loss 0.8482, average loss: 0.8969, latest average loss: 0.8564        
Time 03.53.41, batches 20700, current loss 0.8837, average loss: 0.8967, latest average loss: 0.8595        
Time 03.53.59, batches 20800, current loss 0.9151, average loss: 0.8966, latest average loss: 0.8630        
Time 03.54.17, batches 20900, current loss 0.8773, average loss: 0.8964, latest average loss: 0.8645        
Time 03.54.36, batches 21000, current loss 0.8748, average loss: 0.8962, latest average loss: 0.8612        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:56<00:00,  1.58s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:05<00:00,  1.00s/it] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:31<03:59, 737.78it/s] 
Time 04.03.02, batches 21000, validation AUC: 0.6521, validation MRR: 0.2965, validation nDCG@5: 0.3272, validation nDCG@10: 0.3940,
Time 04.03.23, batches 21100, current loss 0.8682, average loss: 0.8961, latest average loss: 0.8608        
Time 04.03.41, batches 21200, current loss 0.8069, average loss: 0.8959, latest average loss: 0.8580        
Time 04.03.59, batches 21300, current loss 0.9284, average loss: 0.8957, latest average loss: 0.8590        
Time 04.04.17, batches 21400, current loss 0.8876, average loss: 0.8955, latest average loss: 0.8584        
Time 04.04.35, batches 21500, current loss 0.7804, average loss: 0.8954, latest average loss: 0.8586        
Time 04.04.54, batches 21600, current loss 0.9445, average loss: 0.8952, latest average loss: 0.8615        
Time 04.05.12, batches 21700, current loss 0.9463, average loss: 0.8951, latest average loss: 0.8601        
Time 04.05.30, batches 21800, current loss 0.8981, average loss: 0.8949, latest average loss: 0.8575        
Time 04.06.02, batches 21900, current loss 0.8791, average loss: 0.8947, latest average loss: 0.8562        
Time 04.06.20, batches 22000, current loss 0.8766, average loss: 0.8946, latest average loss: 0.8621        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.59s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:06<00:00,  1.01s/it] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:29<03:57, 742.45it/s] 
Time 04.14.45, batches 22000, validation AUC: 0.6554, validation MRR: 0.2999, validation nDCG@5: 0.3308, validation nDCG@10: 0.3975,
Time 04.15.05, batches 22100, current loss 0.8699, average loss: 0.8944, latest average loss: 0.8574        
Time 04.15.24, batches 22200, current loss 0.8847, average loss: 0.8942, latest average loss: 0.8582        
Time 04.15.42, batches 22300, current loss 0.8014, average loss: 0.8941, latest average loss: 0.8605        
Time 04.16.00, batches 22400, current loss 0.9322, average loss: 0.8940, latest average loss: 0.8630        
Time 04.16.18, batches 22500, current loss 0.7929, average loss: 0.8938, latest average loss: 0.8582        
Time 04.16.36, batches 22600, current loss 0.8040, average loss: 0.8936, latest average loss: 0.8595        
Time 04.16.54, batches 22700, current loss 0.9337, average loss: 0.8934, latest average loss: 0.8587        
Time 04.17.13, batches 22800, current loss 1.0239, average loss: 0.8933, latest average loss: 0.8571        
Time 04.17.31, batches 22900, current loss 0.8564, average loss: 0.8931, latest average loss: 0.8534        
Time 04.17.49, batches 23000, current loss 0.9549, average loss: 0.8929, latest average loss: 0.8545        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.61s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:05<00:00,  1.00s/it] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:28<03:56, 744.84it/s] 
Time 04.26.13, batches 23000, validation AUC: 0.6558, validation MRR: 0.3029, validation nDCG@5: 0.3337, validation nDCG@10: 0.4000,
Time 04.26.48, batches 23100, current loss 0.8909, average loss: 0.8928, latest average loss: 0.8584        
Time 04.27.06, batches 23200, current loss 0.8050, average loss: 0.8927, latest average loss: 0.8593        
Time 04.27.24, batches 23300, current loss 0.8791, average loss: 0.8925, latest average loss: 0.8603        
Time 04.27.43, batches 23400, current loss 0.8960, average loss: 0.8924, latest average loss: 0.8582        
Time 04.28.01, batches 23500, current loss 0.7792, average loss: 0.8922, latest average loss: 0.8592        
Time 04.28.19, batches 23600, current loss 0.9037, average loss: 0.8921, latest average loss: 0.8581        
Time 04.28.37, batches 23700, current loss 0.9644, average loss: 0.8919, latest average loss: 0.8585        
Time 04.28.55, batches 23800, current loss 0.9152, average loss: 0.8917, latest average loss: 0.8538        
Time 04.29.13, batches 23900, current loss 0.8721, average loss: 0.8916, latest average loss: 0.8540        
Time 04.29.32, batches 24000, current loss 0.7375, average loss: 0.8914, latest average loss: 0.8531        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.60s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:05<00:00,  1.00s/it] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:30<03:58, 739.14it/s] 
Time 04.37.58, batches 24000, validation AUC: 0.6551, validation MRR: 0.2998, validation nDCG@5: 0.3305, validation nDCG@10: 0.3975,
Time 04.38.18, batches 24100, current loss 0.8168, average loss: 0.8912, latest average loss: 0.8504        
Time 04.38.36, batches 24200, current loss 0.8385, average loss: 0.8911, latest average loss: 0.8509        
Time 04.38.55, batches 24300, current loss 0.9091, average loss: 0.8910, latest average loss: 0.8587        
Time 04.39.13, batches 24400, current loss 0.8530, average loss: 0.8909, latest average loss: 0.8601        
Time 04.39.31, batches 24500, current loss 0.8078, average loss: 0.8907, latest average loss: 0.8545        
Time 04.39.50, batches 24600, current loss 0.7157, average loss: 0.8905, latest average loss: 0.8537        
Time 04.40.08, batches 24700, current loss 0.8298, average loss: 0.8904, latest average loss: 0.8518        
Time 04.40.26, batches 24800, current loss 0.8993, average loss: 0.8902, latest average loss: 0.8532        
Time 04.40.44, batches 24900, current loss 0.9020, average loss: 0.8900, latest average loss: 0.8491        
Time 04.41.03, batches 25000, current loss 0.7828, average loss: 0.8899, latest average loss: 0.8506        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.58s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:05<00:00,  1.00s/it] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:38<04:05, 719.05it/s] 
Time 04.49.36, batches 25000, validation AUC: 0.6522, validation MRR: 0.2995, validation nDCG@5: 0.3305, validation nDCG@10: 0.3970,
Time 04.49.57, batches 25100, current loss 0.8007, average loss: 0.8897, latest average loss: 0.8440        
Time 04.50.15, batches 25200, current loss 0.8999, average loss: 0.8895, latest average loss: 0.8470        
Training data exhausted for 1 times after 25214 batches, reuse the dataset.                                 
Time 04.51.41, batches 25300, current loss 0.9559, average loss: 0.8893, latest average loss: 0.8432        
Time 04.51.59, batches 25400, current loss 0.8706, average loss: 0.8892, latest average loss: 0.8464        
Time 04.52.17, batches 25500, current loss 0.8769, average loss: 0.8890, latest average loss: 0.8458        
Time 04.52.35, batches 25600, current loss 0.8910, average loss: 0.8888, latest average loss: 0.8463        
Time 04.52.53, batches 25700, current loss 0.7676, average loss: 0.8887, latest average loss: 0.8483        
Time 04.53.11, batches 25800, current loss 0.8121, average loss: 0.8886, latest average loss: 0.8526        
Time 04.53.29, batches 25900, current loss 0.7776, average loss: 0.8884, latest average loss: 0.8496        
Time 04.53.48, batches 26000, current loss 0.8335, average loss: 0.8883, latest average loss: 0.8520        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:56<00:00,  1.57s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:04<00:00,  1.01it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:33<04:01, 731.55it/s] 
Time 05.02.14, batches 26000, validation AUC: 0.6554, validation MRR: 0.3016, validation nDCG@5: 0.3329, validation nDCG@10: 0.3995,
Time 05.02.35, batches 26100, current loss 0.7261, average loss: 0.8881, latest average loss: 0.8497        
Time 05.02.53, batches 26200, current loss 0.8159, average loss: 0.8880, latest average loss: 0.8506        
Time 05.03.11, batches 26300, current loss 0.8940, average loss: 0.8878, latest average loss: 0.8483        
Time 05.03.30, batches 26400, current loss 0.8911, average loss: 0.8877, latest average loss: 0.8486        
Time 05.03.48, batches 26500, current loss 0.8703, average loss: 0.8875, latest average loss: 0.8471        
Time 05.04.06, batches 26600, current loss 0.7918, average loss: 0.8874, latest average loss: 0.8495        
Time 05.04.24, batches 26700, current loss 0.9088, average loss: 0.8873, latest average loss: 0.8495        
Time 05.04.43, batches 26800, current loss 0.8544, average loss: 0.8871, latest average loss: 0.8500        
Time 05.05.01, batches 26900, current loss 0.8320, average loss: 0.8869, latest average loss: 0.8421        
Time 05.05.19, batches 27000, current loss 0.8589, average loss: 0.8867, latest average loss: 0.8373        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:56<00:00,  1.58s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:14<00:00,  1.08s/it] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:26<03:54, 751.34it/s] 
Time 05.13.50, batches 27000, validation AUC: 0.6507, validation MRR: 0.2981, validation nDCG@5: 0.3284, validation nDCG@10: 0.3956,
Time 05.14.10, batches 27100, current loss 0.8061, average loss: 0.8866, latest average loss: 0.8426        
Time 05.14.28, batches 27200, current loss 0.7619, average loss: 0.8865, latest average loss: 0.8475        
Time 05.14.46, batches 27300, current loss 0.8064, average loss: 0.8863, latest average loss: 0.8479        
Time 05.15.04, batches 27400, current loss 0.9649, average loss: 0.8862, latest average loss: 0.8464        
Time 05.15.22, batches 27500, current loss 0.9201, average loss: 0.8860, latest average loss: 0.8429        
Time 05.15.41, batches 27600, current loss 0.7884, average loss: 0.8859, latest average loss: 0.8452        
Time 05.15.59, batches 27700, current loss 0.8607, average loss: 0.8857, latest average loss: 0.8443        
Time 05.16.17, batches 27800, current loss 0.9141, average loss: 0.8855, latest average loss: 0.8429        
Time 05.16.35, batches 27900, current loss 0.8262, average loss: 0.8854, latest average loss: 0.8418        
Time 05.16.53, batches 28000, current loss 0.8647, average loss: 0.8852, latest average loss: 0.8428        
Calculating vectors for news: 100%|████████████████████████████████████████| 36/36 [00:57<00:00,  1.60s/it] 
Calculating vectors for users: 100%|█████████████████████████████████████| 125/125 [02:03<00:00,  1.01it/s] 
Calculating probabilities:  53%|██████████████████                | 199999/376471 [04:28<03:57, 743.82it/s] 
Time 05.25.16, batches 28000, validation AUC: 0.6540, validation MRR: 0.3006, validation nDCG@5: 0.3312, validation nDCG@10: 0.3983,
Early stop.
Training:  56%|███████████████████████████▊                      | 27999/50426 [5:25:16<4:20:32,  1.43it/s] 
PS D:\HieuDT\news-recommendation\src>
